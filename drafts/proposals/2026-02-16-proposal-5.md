# Title Page
**Title:** Transfer Learning and Multi-Task Neural Networks for Option Pricing Across Underlyings: Robustness Across Market Regimes Using IvyDB US

**Date:** 2026-02-16  
**Name:** Maurits van Eck  
**ANR:** 2062644  
**Program:** MSc Finance, Tilburg University  

---

## Part 1 — Research Question (~200 words)
Machine learning option pricing models are often trained separately for each underlying (or each market), which can be data-inefficient and may lead to unstable performance when regimes change. However, option pricing relationships share structure across underlyings: moneyness–maturity patterns, monotonicity/convexity restrictions, and common drivers such as volatility clustering and market-wide tail risk. A multi-task or transfer learning approach could pool information across underlyings to improve generalization, especially for less liquid names and during stress periods.

**Research question:**

1) *Does transfer learning (pretraining on a broad panel of liquid underlyings, then fine-tuning) improve option pricing accuracy and hedging Greeks relative to single-underlying models and classical benchmarks?*

2) *Are gains larger in challenging settings: low-liquidity names, short maturities, and crisis regimes (high VIX / high realized volatility)?*

3) *Can the model be constrained to remain economically consistent (no-arbitrage shape constraints), and do such constraints improve out-of-sample robustness?*

This thesis is economically important because practitioners regularly need scalable models across many names, and because regime-robust pricing and hedging is central to risk management.

---

## Part 2 — Literature Review (MAX 1 PAGE)
No-arbitrage option pricing theory (Black & Scholes, 1973; Merton, 1973) provides structural restrictions that any empirical model should respect. Empirical option markets display stable cross-sectional patterns (skew, term structure) but time variation across regimes. Pure ML regressors can fit prices well in-sample but may violate monotonicity/convexity and extrapolate poorly.

The derivatives ML literature includes neural network pricing models, implied volatility surface learning, and constraint-aware approaches (e.g., arbitrage-free surface repair and generation). Work on arbitrage-free surface methods (Ning et al., 2021; Zhang et al., 2021; and strictly arbitrage-free surface representations such as SANOS) highlights the role of economic constraints.

Transfer learning is widely used in machine learning to improve sample efficiency, but its application in option pricing is less systematically tested in an IvyDB-scale empirical setting. Multi-task learning can be interpreted as a modern shrinkage approach: learning shared representations across underlyings while allowing idiosyncratic adjustments. In finance, this corresponds to capturing common risk drivers while permitting firm-specific features (dividend policy, liquidity).

This thesis contributes by designing an empirically grounded multi-task option pricing model across many U.S. underlyings, evaluating not only pricing RMSE but also hedging error and regime robustness, and benchmarking against classical methods.

---

## Part 3 — Research Plan (~500 words; includes regression equations)
### 3.1 Pricing target and inputs
For contract i on day t, let observed mid price be \(P_{i,t}\), with features \(X_{i,t}\) including \(S_t\), \(K\), \(\tau\), interest rate \(r\), dividend yield \(q\), and market state variables (realized vol, VIX).

Model the normalized price (or implied vol):
\[
Y_{i,t} = f_\theta(X_{i,t}, u(i))
\]
where \(u(i)\) identifies the underlying (task). The model shares parameters across tasks with task embeddings or hierarchical layers.

### 3.2 Transfer learning design
1) **Pretraining:** train on a broad set of liquid underlyings (large data) to learn a general representation.
2) **Fine-tuning:** adapt the model to a target underlying with limited data.
3) **Multi-task alternative:** train jointly with shared trunk + task-specific heads.

### 3.3 Economic constraints
Impose no-arbitrage shape constraints in strike (for fixed \(S,t,\tau\)):
- Call price decreasing in strike: \(\partial C/\partial K \le 0\)
- Convexity: \(\partial^2 C/\partial K^2 \ge 0\)
Analogous constraints for puts and/or in implied vol space via penalties. Also enforce bounds (intrinsic value lower bound, upper bounds).

### 3.4 Evaluation metrics
- Pricing error: RMSE/MAE by buckets (moneyness × maturity).
- Arbitrage diagnostics: fraction of violations before/after constraints.
- Hedging performance: delta-hedging error using model-implied deltas.

### 3.5 Regression-based tests of robustness
Test whether transfer learning improves errors particularly in difficult regimes:
\[
|P_{i,t}-\widehat{P}_{i,t}| = \alpha + \beta_1 \mathbb{1}[\text{Transfer}] + \beta_2 \mathbb{1}[\text{Crisis}_t] + \beta_3 \mathbb{1}[\text{Transfer}]\times \mathbb{1}[\text{Crisis}_t] + \Gamma'Z_{i,t} + \varepsilon_{i,t}
\]
where \(\text{Crisis}_t\) is defined by VIX quantiles; \(Z\) includes liquidity and contract controls.

Similarly for hedging error:
\[
|HE_{i,t+1}| = \alpha + \delta_1 \mathbb{1}[\text{Transfer}] + \delta_2 \text{Spread}_{i,t} + \delta_3 \text{Moneyness}_{i,t} + \delta_4 \tau_{i,t} + u_{i,t+1}
\]

Robustness: compare against per-underlying models, pooled model without task structure, and classical implied-vol interpolation baselines.

---

## Part 4 — Data Sources (~400 words; includes descriptive statistics table)
**Primary dataset (verified access):** OptionMetrics IvyDB US via WRDS (Tilburg University access verified). This dataset is well-suited for transfer learning because it covers a large cross-section of underlyings and long time spans.

**Sample plan:**
- Choose 50–200 underlyings with sufficient liquidity (based on volume/open interest thresholds).
- Split data by time to ensure genuine out-of-sample evaluation.
- Standardize inputs (moneyness, maturity, rates) and align contract definitions.

**Liquidity and microstructure:**
- Include bid–ask spreads to filter and to model transaction costs in hedging.
- Report results separately for “liquid” and “less liquid” subsets.

**Descriptive statistics table (to be completed):**

| Variable | Mean | Std | P5 | P50 | P95 | Notes |
|---|---:|---:|---:|---:|---:|---|
| Number of underlyings |  |  |  |  |  | sample definition |
| Contracts per day |  |  |  |  |  | panel density |
| Relative bid–ask spread |  |  |  |  |  | liquidity |
| Pricing RMSE (baseline) |  |  |  |  |  | by bucket |
| Pricing RMSE (transfer) |  |  |  |  |  | by bucket |

The thesis will clearly document filters and provide a reproducible extraction procedure from WRDS.

---

## Part 5 — References (APA style)
Black, F., & Scholes, M. (1973). The pricing of options and corporate liabilities. *Journal of Political Economy, 81*(3), 637–654.

Merton, R. C. (1973). Theory of rational option pricing. *Bell Journal of Economics and Management Science, 4*(1), 141–183.

Ning, B., Jaimungal, S., Zhang, X., & Bergeron, M. (2021). Arbitrage-free implied volatility surface generation with variational autoencoders. *SIAM Journal on Financial Mathematics, 12*(4), 1977–2009.

Zhang, W.-Y., Li, L., & Zhang, G. (2021). A two-step framework for arbitrage-free prediction of the implied volatility surface. *Quantitative Finance*.

### Additional implementation details (architecture and ablations)
**Architecture.** The baseline neural model will be a feed-forward network on standardized inputs \((k,\tau, IV\_level, IV\_skew, r, q, RV, VIX, \text{liquidity})\). The transfer/multi-task model will add an *underlying embedding* vector \(e_{u}\) learned jointly with the network. The prediction becomes \(\widehat{Y}=f_\theta([X, e_u])\). This is a parsimonious way to capture persistent cross-underlying differences while retaining shared structure.

**Ablations.** I will run a set of ablation studies to isolate what drives gains:
1) pooled model without embeddings (one model for all underlyings),
2) per-underlying model (no pooling),
3) multi-task embeddings, and
4) pretrain + fine-tune.

**Regime robustness.** The crisis indicator will be based on VIX quantiles or realized volatility spikes. I will also evaluate performance during large market moves (e.g., top 1% absolute S\&P 500 returns) to test whether transfer learning improves stability when the mapping from inputs to prices changes.

### Economic evaluation
Even when pricing errors are small, economic usefulness depends on Greeks. Therefore, I will compute model-implied deltas and run a delta-hedging backtest for a standardized option position. Net hedging performance will be reported after transaction costs. A model that prices well but produces unstable deltas is not useful for risk management.

To link transfer learning to market microstructure, I will test whether the largest improvements occur for:
- low-liquidity underlyings (high spreads),
- sparse strike grids (few listed strikes), and
- short maturities where quote noise is high.

### Feasibility and scope control
The project is feasible because it uses end-of-day IvyDB data and relatively standard neural networks. If computational constraints arise, I will restrict to a smaller set of underlyings (e.g., 50 names + SPX) and focus on the most liquid maturity buckets. The methodology still answers the core research question about cross-asset transfer.

### Inference and reporting
Because the dataset is large and highly dependent across contracts, I will summarize statistical uncertainty using both (i) time-series bootstrap of daily aggregated errors and (ii) clustered standard errors in panel regressions (cluster by date and underlying). Improvements will be reported as percentage reductions in RMSE and as differences in hedging error distributions. I will also include a table that decomposes performance by regime and by liquidity quintiles, which is directly interpretable for a finance audience.

**Planned outputs:** (1) pricing error tables by moneyness–maturity bucket, (2) crisis vs calm comparison plots, (3) hedging error distributions using model-implied deltas, and (4) an ablation table comparing pooling vs transfer approaches. These outputs will allow a clear conclusion about whether cross-asset transfer improves robustness.

### Contribution
The contribution is empirical and methodological: it tests whether modern representation learning ideas (transfer and multi-task learning) add value in a core derivatives problem when evaluated with finance-relevant metrics (arbitrage checks, hedging errors, and regime stability). If successful, the approach can serve as a scalable building block for derivative analytics across many names.
Results will be interpreted cautiously, emphasizing out-of-sample robustness and implementability rather than purely in-sample fit.
This directly matches the needs of practitioners.
