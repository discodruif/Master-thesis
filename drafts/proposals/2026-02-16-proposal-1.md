# Title Page
**Title:** Arbitrage-Free Forecasting of the Implied Volatility Surface with Diffusion/Transformer Models: Economic Value for Hedging and Trading

**Date:** 2026-02-16  
**Name:** Maurits van Eck  
**ANR:** 2062644  
**Program:** MSc Finance, Tilburg University  

---

## Part 1 — Research Question (~200 words)
Equity index and single-stock options embed forward-looking information about risk-neutral distributions and tail risk. Practitioners rely on *implied volatility (IV) surfaces*—functions of strike and maturity—to price, hedge, and manage risk. Recent machine learning work forecasts IV surfaces using deep networks and generative models, but two obstacles remain central for empirical asset pricing and trading use: (i) predicted surfaces frequently violate *static no-arbitrage* constraints (calendar and butterfly), and (ii) it is unclear whether lower forecast error translates into *economic value* once hedging/trading constraints and transaction costs are imposed.

**Research question:**

1) *Can modern sequence/generative ML models (diffusion and attention-based architectures) forecast next-day (and multi-day) implied volatility surfaces more accurately than strong econometric benchmarks, while remaining (or being repaired to be) static-arbitrage-free?*

2) *Does improved, arbitrage-free IV-surface forecasting generate economically meaningful gains in (a) delta/vega hedging performance and (b) option trading strategies based on predicted changes in the surface, after transaction costs?*

The project is economically important because systematic users of options (market makers, volatility funds, hedgers) require reliable, arbitrage-free surfaces; violations can induce false signals and mis-hedging. The thesis will quantify both statistical accuracy and economic outcomes (hedging P\&L, risk measures) using verified OptionMetrics IvyDB US data via WRDS.

---

## Part 2 — Literature Review (MAX 1 PAGE)
Classic option theory (Black & Scholes, 1973; Merton, 1973) links option prices to diffusion dynamics and no-arbitrage restrictions. Empirically, the IV surface exhibits persistent skew and term-structure dynamics tied to risk premia and jumps (Bakshi, Kapadia, & Madan, 2003; Carr & Wu, 2009). This motivates forecasting the *surface* rather than individual contracts.

Recent ML contributions model the IV surface using neural networks and deep architectures and emphasize that raw ML predictions often violate no-arbitrage. “Deep smoothing” and related approaches study learning representations of IV surfaces and enforcing structure (e.g., NeurIPS-style implied-vol surface models). More directly, **Zhang, Li, and Zhang (2021, Quantitative Finance)** propose a two-step approach: unconstrained prediction followed by an arbitrage-enforcement repair, demonstrating the importance of constraint-aware evaluation. In generative modeling, **Ning et al. (2021, SIAM Journal on Financial Mathematics)** introduce variational autoencoder (VAE) frameworks to generate arbitrage-free IV surfaces. Newer preprints extend this line to controllable VAE generation (Wang, Liu, & Vuik, 2025) and diffusion models (Jin & Agarwal, 2025), which aim to improve stability relative to GANs.

In parallel, the economics of better volatility forecasts is often assessed via hedging error and trading performance. The “deep hedging” literature (Buehler et al., 2019, *Review of Financial Studies*) demonstrates that learning-based hedging can outperform classical delta hedging once transaction costs and discrete rebalancing are considered. However, most studies focus on learning hedging policies, not on how improvements in *surface forecasts* map into hedging and trading gains. This thesis bridges these streams by comparing forecasting models (transformer/diffusion vs econometric baselines), enforcing static arbitrage (e.g., via repair layers or arbitrage-free surface construction such as SANOS; Buehler et al., 2026), and measuring the incremental economic value.

Target journals for positioning: *Journal of Finance, Journal of Financial Economics, Review of Financial Studies, Journal of Financial and Quantitative Analysis, Review of Finance, Management Science*.

---

## Part 3 — Research Plan (~500 words; includes regression equations)
### 3.1 Empirical setting and prediction target
Define the daily IV surface for an underlying (e.g., SPX, or a panel of large-cap equities) on day *t* as a grid over moneyness and maturity. Let \(IV_{t}(k,\tau)\) denote implied volatility at log-moneyness \(k = \log(K/S)\) and maturity \(\tau\).

The thesis will forecast \(IV_{t+1}(k,\tau)\) (and possibly \(t+h\)) using historical information available at *t*.

### 3.2 Baselines and ML models
**Baselines:**
- Random walk / “no-change” baseline: \(\widehat{IV}_{t+1}=IV_t\).
- Surface factor models / PCA on IV grids with VAR dynamics.
- Option-implied state variables (level, slope, curvature; term-structure factors).

**ML models:**
- Transformer encoder (attention over surface history) predicting a latent factor representation and reconstructing the grid.
- Conditional diffusion model generating \(IV_{t+1}\) conditional on recent surfaces (cf. Jin & Agarwal, 2025).

### 3.3 No-arbitrage enforcement
Two approaches will be compared:
1) **Repair layer:** predict an unconstrained surface \(\widetilde{IV}\), then solve a constrained optimization to obtain \(\widehat{IV}\) with no calendar/butterfly arbitrage (Zhang et al., 2021).
2) **Arbitrage-free construction:** build a strictly arbitrage-free option price surface representation and map to IV (e.g., SANOS; Buehler et al., 2026).

### 3.4 Statistical evaluation
Compute pointwise errors and surface-level metrics:
- RMSE over the grid.
- Arbitrage violation counts/magnitudes.
- Tail-weighted errors (OTM puts/calls) relevant for risk management.

### 3.5 Economic value: hedging and trading tests
**Hedging test:** Consider a delta-hedged option position rebalanced daily. Define hedging error for contract i:
\[
HE_{i,t+1}= \Delta V_{i,t+1} - \widehat{\Delta}_{i,t} \Delta S_{t+1} - \widehat{\nu}_{i,t} \Delta IV_{t+1} - TC_{i,t}
\]
where \(\widehat{\Delta}_{i,t}\) and \(\widehat{\nu}_{i,t}\) are Greeks computed from the forecasted arbitrage-free surface, and \(TC_{i,t}\) are transaction costs from rebalancing.

A panel regression evaluates whether forecast improvements reduce hedging error:
\[
|HE_{i,t+1}| = \alpha + \beta_1 \text{Model}_m + \beta_2 \text{Liquidity}_{i,t} + \beta_3 \text{Moneyness}_{i,t} + \beta_4 \tau_{i,t} + \varepsilon_{i,t+1}
\]
where \(\text{Model}_m\) are model indicators or continuous forecast-quality measures.

**Trading strategy:** Construct signals from predicted surface changes (e.g., predicted increase in skew or in ATM term-structure). Example cross-sectional regression of next-day option returns:
\[
R^{opt}_{i,t+1} = \alpha + \gamma_1 \widehat{\Delta IV}_{t}(k_i,\tau_i) + \gamma_2 \text{Controls}_{i,t} + u_{i,t+1}
\]
Controls include bid–ask, open interest, realized volatility, and lagged returns. Portfolio sorts (long predicted underpriced vs short overpriced) with transaction cost adjustments provide economic performance measures (Sharpe, drawdowns, turnover).

Robustness: subperiods (crisis vs calm), underlying types, different grid definitions, and alternative cost assumptions.

---

## Part 4 — Data Sources (~400 words; includes descriptive statistics table)
**Primary dataset (verified access):** OptionMetrics IvyDB US via WRDS (Tilburg University access verified). This database provides end-of-day option quotes, implied volatilities, Greeks (when available), and underlying data for U.S. equity and index options.

**Sample construction (planned):**
- Underlyings: start with SPX (index options) due to depth/liquidity; extend to a panel of large-cap equity options.
- Filters: remove options with zero bid, extremely low prices, abnormal implied vols, and very short time-to-maturity (< 7 days). Use standard moneyness/maturity bins.
- Create daily IV grids using interpolation from observed strikes/maturities, then apply no-arbitrage enforcement if needed.

**Additional variables:**
- Realized volatility from underlying returns.
- Market state variables (VIX, S\&P 500 returns, interest rates) if required.

**Transaction costs:**
- Use OptionMetrics bid–ask spreads to compute half-spread costs; include underlying transaction costs for hedging trades.

**Descriptive statistics (to be produced in the thesis):**

| Variable | Mean | Std | P5 | P50 | P95 | Notes |
|---|---:|---:|---:|---:|---:|---|
| Implied volatility (ATM) |  |  |  |  |  | daily, per underlying |
| Skew (25Δ put – ATM) |  |  |  |  |  | slope measure |
| Term structure (90d – 30d ATM) |  |  |  |  |  | maturity spread |
| Option bid–ask (relative) |  |  |  |  |  | liquidity proxy |
| Underlying realized vol (20d) |  |  |  |  |  | control |

The table will be filled after extracting the IvyDB sample. All computations will be reproducible (code + versioned outputs).

---

## Part 5 — References (APA style)
Bakshi, G., Kapadia, N., & Madan, D. (2003). Stock return characteristics, skew laws, and the differential pricing of individual equity options. *Review of Financial Studies, 16*(1), 101–143.

Black, F., & Scholes, M. (1973). The pricing of options and corporate liabilities. *Journal of Political Economy, 81*(3), 637–654.

Buehler, H., Gonon, L., Teichmann, J., & Wood, B. (2019). Deep hedging. *Review of Financial Studies, 32*(12), 4245–4275.

Buehler, H., Horvath, B., Kratsios, A., Limmer, Y., & Saqur, R. (2026). SANOS: Smooth strictly arbitrage-free non-parametric option surfaces. *arXiv preprint* (2601.11209).

Carr, P., & Wu, L. (2009). Variance risk premiums. *Review of Financial Studies, 22*(3), 1311–1341.

Jin, C., & Agarwal, A. (2025). Forecasting implied volatility surface with generative diffusion models. *arXiv preprint* (2511.07571).

Merton, R. C. (1973). Theory of rational option pricing. *Bell Journal of Economics and Management Science, 4*(1), 141–183.

Ning, B., Jaimungal, S., Zhang, X., & Bergeron, M. (2021). Arbitrage-free implied volatility surface generation with variational autoencoders. *SIAM Journal on Financial Mathematics, 12*(4), 1977–2009.

Wang, J., Liu, S., & Vuik, C. (2025). Controllable generation of implied volatility surfaces with variational autoencoders. *arXiv preprint* (2509.01743).

Zhang, W.-Y., Li, L., & Zhang, G. (2021). A two-step framework for arbitrage-free prediction of the implied volatility surface. *Quantitative Finance*.

### Additional implementation notes (model risk and inference)
To ensure that results are interpretable in a finance context, I will (i) report *out-of-sample* performance using a strict rolling-origin evaluation, (ii) use standard error adjustments for panel dependence (e.g., double-clustered by date and underlying when applicable), and (iii) benchmark against practitioner heuristics (e.g., spline surfaces with simple AR dynamics). Because static-arbitrage constraints can interact with predictive content, I will separately report “raw” prediction accuracy and “post-repair” accuracy to quantify how much of the forecast is altered by enforcing no-arbitrage. Finally, I will evaluate whether gains concentrate in economically important regions of the surface (OTM puts and short maturities) by using value-weighted error metrics that weight contracts by vega and trading volume proxies.
