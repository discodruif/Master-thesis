# Thesis Proposal 1 (Tilburg MSc Finance)

## Title Page
**Title:** No‑Arbitrage Constrained Machine Learning for Implied Volatility Surfaces: Pricing and Hedging Implications in SPX Options  
**Date:** 2026-02-16  
**Name:** Maurits van Eck  
**ANR:** 2062644  
**Program:** MSc Finance, Tilburg University  

---

## Part 1 — Research Question (~200 words)
Option prices embed investors’ expectations about future risk through the *implied volatility surface* (IVS). In practice, empirical IV surfaces are noisy, sparse, and sometimes violate static no‑arbitrage constraints (monotonicity/convexity in strike; calendar constraints across maturity). Such violations can mechanically distort downstream tasks: model calibration, option valuation, and hedging error measurement. The central research question is:

**RQ:** *Does enforcing no‑arbitrage constraints in machine‑learning models of the implied volatility surface improve (i) out‑of‑sample option pricing accuracy and (ii) transaction‑cost‑adjusted hedging performance relative to unconstrained ML and classical parametric benchmarks?*

I focus on equity index options (S&P 500 / SPX) where liquidity is high and the IV surface is economically central. The project is economically important for three reasons. First, many ML methods can overfit local quote noise; “better fit” may not translate to better trading/hedging outcomes if the surface violates economic restrictions. Second, constraint satisfaction matters operationally: dealers require arbitrage‑free surfaces for risk and P&L reporting. Third, by connecting statistical gains (surface fit) to economic gains (hedging error net of transaction costs), the thesis directly evaluates whether “financial structure + ML” delivers implementable value.

---

## Part 2 — Literature Review (MAX 1 page)
Classic option pricing (Black & Scholes, 1973) and stochastic volatility (Heston, 1993) provide parametric structures but struggle to match the full cross‑section of option prices without frequent recalibration. Nonparametric IV surface estimation is widely used in practice, yet must respect static arbitrage conditions (e.g., convexity in strike for call prices; monotonicity across maturity). Recent ML literature increasingly recognizes that pure function approximation can violate economic constraints.

A key strand is **physics‑informed / constraint‑aware learning**. *Whack‑a‑mole Learning: Physics‑Informed Deep Calibration for Implied Volatility Surface* (Hoshisashi, Phelan & Barucca, 2024) proposes adaptive loss reweighting to fit IVS while aligning with PDE structure and no‑arbitrage inequalities, addressing the multi‑objective nature of constrained calibration. Another applied line embeds surface information into downstream hedging. *Enhancing Deep Hedging of Options with Implied Volatility Surface Feedback Information* (François et al., 2024) shows that including IVS dynamics as state variables improves RL‑based hedging relative to delta‑style benchmarks, especially with transaction costs.

The deep hedging literature (e.g., Buehler et al., 2019, *Quantitative Finance*) reframes hedging as direct optimization of an economic objective under discrete trading and frictions. This motivates evaluating *economic* outcomes rather than only pricing RMSE. For IV surface dynamics and scenario generation, *FuNVol* (Choudhary, Jaimungal & Bergeron, 2023) models multi‑asset IV evolution via functional PCA and neural SDEs, suggesting a modern approach to representing the full surface across strikes/maturities.

In top finance journals, the broader theme is that richer information sets and nonlinear methods can improve forecasting and asset pricing (e.g., evidence in RFS and related outlets). The thesis contributes by providing an explicit empirical test: whether **no‑arbitrage constraints** in ML surface modeling translate into *better pricing and hedging* for a liquid option market.

---

## Part 3 — Research Plan (~500 words; include regression equations)
### 3.1 Overview
I will build daily IV surfaces from IvyDB US (SPX options) and compare three families of models:

1. **Parametric benchmarks:** SVI‑type volatility parameterizations or Heston‑style calibration proxies (as feasible in the timeframe).
2. **Unconstrained ML surface models:** flexible neural nets trained to map moneyness and maturity to implied vol (or price).
3. **Constrained ML surface models:** models trained with explicit penalties/constraints ensuring static no‑arbitrage conditions (inspired by Hoshisashi et al., 2024), plus smoothing/regularization.

### 3.2 Targets and evaluation
**Surface fit:** out‑of‑sample IV errors (MAE/RMSE) using a time split (train on past days, test on future days). Also report frequency/magnitude of arbitrage violations.

**Pricing implication:** construct option prices from the fitted IVS (via Black‑Scholes inversion for European options; for American options use approximation/benchmark where appropriate). Evaluate pricing RMSE vs mid‑quotes.

**Hedging implication:** delta‑hedge short option positions using deltas implied by each surface and compute hedging P&L net of transaction costs.

### 3.3 Concrete equations
**(A) Static no‑arbitrage constraints (conceptual):** for call prices C(K,T):
- ∂C/∂K ≤ 0 (monotone in strike)
- ∂²C/∂K² ≥ 0 (convex in strike)
- ∂C/∂T ≥ 0 (calendar monotonicity)

Implement as penalties using automatic differentiation on the ML surface (learning IV or price directly).

**(B) Hedging error regression (economic evaluation):** for option i on day t, define hedging error HE_{i,t} over the next rebalancing interval (e.g., daily). Compare models m via:

\[
HE_{i,t}^{(m)} = \alpha_m + \beta_1 \lvert\Delta\sigma_{t}\rvert + \beta_2 \text{TC}_{i,t} + \beta_3 \text{VIX}_{t} + \beta_4 \text{Moneyness}_{i,t} + \beta_5 \text{TTM}_{i,t} + \varepsilon_{i,t}
\]

where \(\Delta\sigma_t\) captures realized vol shocks, TC is estimated transaction costs from bid‑ask and rehedging, and VIX controls for volatility regimes. The key coefficient of interest is **model fixed effects**: whether constrained surfaces reduce HE in high‑volatility regimes.

**(C) Pricing error regression:**
\[
\lvert PE_{i,t}^{(m)}\rvert = \gamma_m + \delta_1 \text{BidAsk}_{i,t} + \delta_2 \text{Moneyness}_{i,t} + \delta_3 \text{TTM}_{i,t} + u_{i,t}
\]

This links error to microstructure noise and allows direct comparison across models.

### 3.4 Identification, implementation, and robustness
**Implementation details.** I will estimate the IV surface each trading day using cross‑sectional option quotes. Inputs will be \((\ln(K/F_t),\; T,\; \text{option type},\;\text{rate})\) and the target will be either implied volatility or mid price. For constrained models, I will (i) predict a smooth IV surface and (ii) translate it into call prices \(C(K,T)\) to evaluate arbitrage constraints. Constraints will be implemented via differentiable penalties and/or “softplus” parameterizations that enforce non‑negativity of second derivatives. Hyperparameters (penalty weights, network depth, regularization) will be selected using a validation period and a loss that mixes fit + violation penalties.

**Identification and robustness.**
- Use rolling windows (expanding and fixed‑length) to avoid look‑ahead bias; evaluate stability across calm vs stressed volatility regimes.
- Cluster standard errors by date and maturity (two‑way where feasible) to address cross‑sectional dependence.
- Robustness to alternative surface coordinates (log‑moneyness vs delta buckets), filtering rules, and minimum liquidity thresholds.
- Robustness to hedging frequency (daily vs intraday proxy where available) and transaction cost assumptions (full spread vs half‑spread; additional slippage).

**Economic significance.** Besides average pricing/hedging error, I will report distributional outcomes (P95 hedging loss, CVaR of losses) because tail performance is central for risk management and is the channel through which “arbitrage‑free smoothing” may matter most.

---

## Part 4 — Data Sources (~400 words; include descriptive statistics table; confirm access)
**Primary data:** **OptionMetrics IvyDB US via WRDS (access verified).** I will use SPX option quotes (bid/ask, implied volatility, Greeks where provided), contract characteristics (strike, maturity, option type), and underlying index levels. I will focus on end‑of‑day quotes and standard filters (exclude stale quotes; minimum open interest/volume thresholds; remove extreme moneyness or zero bids).

**Supplementary data (WRDS):** CRSP for index returns (or S&P 500 index return series), and risk‑free rates (e.g., Treasury yields) for discounting and forward price construction. VIX can be added to capture regimes.

**Sample construction:** Daily panels of options across strikes and maturities. I will build an IV grid in delta‑maturity space (common in practice), then map to strike‑maturity for arbitrage checks.

**Transaction costs:** Bid‑ask spreads from IvyDB will proxy proportional trading costs; rehedging costs computed from spread × traded notional. I will explicitly distinguish *quote-based* costs (half‑spread) from *implementation* costs (full spread + slippage) and show sensitivity of conclusions to these assumptions. If available, I will also use volume/open‑interest filters to focus on contracts where spreads are economically meaningful and trades are feasible.

**No‑arbitrage diagnostics data.** For each date, I will compute diagnostic measures such as the fraction of strike grid points violating convexity (negative \(\partial^2 C/\partial K^2\)), and the maximum violation magnitude. These diagnostics will be reported alongside fit metrics to make clear when constrained learning trades off local fit for global economic consistency.

### Descriptive statistics (template)
A required descriptive statistics table will be produced for the final thesis. Example layout:

| Variable | Mean | Std | P5 | P50 | P95 | N |
|---|---:|---:|---:|---:|---:|---:|
| Implied volatility (IV) |  |  |  |  |  |  |
| Log-moneyness (ln(K/F)) |  |  |  |  |  |  |
| Time-to-maturity (days) |  |  |  |  |  |  |
| Bid-ask spread (IV or $) |  |  |  |  |  |  |
| Option mid price |  |  |  |  |  |  |
| Underlying return (daily) |  |  |  |  |  |  |

I will report these for the full sample and by moneyness/TTM buckets.

---

## Part 5 — References (APA)
Black, F., & Scholes, M. (1973). The pricing of options and corporate liabilities. *Journal of Political Economy, 81*(3), 637–654.

Buehler, H., Gonon, L., Teichmann, J., & Wood, B. (2019). Deep hedging. *Quantitative Finance, 19*(8), 1271–1291.

Choudhary, V., Jaimungal, S., & Bergeron, M. (2023). FuNVol: A multi-asset implied volatility market simulator using functional principal components and neural SDEs. *arXiv* / working paper.

François, P., Gauthier, G., Godin, F., & Pérez Mendoza, C. O. (2024). Enhancing deep hedging of options with implied volatility surface feedback information. *arXiv*.

Heston, S. L. (1993). A closed-form solution for options with stochastic volatility with applications to bond and currency options. *Review of Financial Studies, 6*(2), 327–343.

Hoshisashi, K., Phelan, C. E., & Barucca, P. (2024). Whack-a-mole learning: Physics-informed deep calibration for implied volatility surface. *Proceedings/working paper*.
